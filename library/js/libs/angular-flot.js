angular.module("angular-flot",[]).directive("flot",["$timeout",function(u){return{restrict:"EA",template:"<div></div>",scope:{dataset:"=",options:"=",callback:"=",onPlotClick:"&",onPlotHover:"&",onPlotSelected:"&",onPlotUnselected:"&"},link:function(n,t,e){var o=null,i=e.width||"100%",l=e.height||"100%";if(((n.options||{}).legend||{}).container instanceof jQuery)throw new Error('Please use a jQuery expression string with the "legend.container" option.');n.dataset||(n.dataset=[]),n.options||(n.options={legend:{show:!1}});var c=$(t.children()[0]);c.css({width:i,height:l});var s=function(){var t=$.plot(c,n.dataset,n.options);return n.callback&&n.callback(t),t};c.on("plotclick",function(t,e,o){u(function(){n.onPlotClick({event:t,pos:e,item:o})})}),c.on("plotselected",function(t,e){u(function(){n.onPlotSelected({event:t,ranges:e})})}),c.on("plotunselected",function(t){u(function(){n.onPlotUnselected({event:t})})}),c.on("plothover",function(t,e,o){u(function(){n.onPlotHover({event:t,pos:e,item:o})})});var r=n.$watch("options",function(){o=s()},!0),a=n.$watch("dataset",function(t){if(o)return o.setData(t),o.setupGrid(),o.draw();o=s()},!0);e.$observe("width",function(t){t&&(i=t,c.css("width",t))}),e.$observe("height",function(t){t&&(l=t,c.css("height",t))}),t.on("$destroy",function(){c.off("plotclick"),c.off("plothover"),c.off("plotselected"),c.off("unplotselected"),o.destroy(),a(),r()})}}}]);