!function(e){"use strict";"function"==typeof define&&define.amd?define(["angular","./Sortable"],e):"function"==typeof require&&"object"==typeof exports&&"object"==typeof module?(require("angular"),e(angular,require("./Sortable")),module.exports="ng-sortable"):window.angular&&window.Sortable&&e(angular,Sortable)}(function(S,m){"use strict";var y="Sortable:ng-sortable";S.module("ng-sortable",[]).constant("ngSortableVersion","0.4.0").constant("ngSortableConfig",{}).directive("ngSortable",["$parse","ngSortableConfig",function(f,p){var g,b;function r(e){return e.getAttribute("ng-repeat")||e.getAttribute("data-ng-repeat")||e.getAttribute("x-ng-repeat")}return{restrict:"AC",scope:{ngSortable:"=?"},priority:1001,compile:function(e,n){var t=[].filter.call(e[0].childNodes,function(e){return e.nodeType===Node.ELEMENT_NODE&&r(e)})[0];if(t){var o=r(t).match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/);if(o){var d=o[2];return function(i,e){var n,a,t=f(d),l=function(){return t(i.$parent)||[]},s=e[0],r=S.extend(i.ngSortable||{},p),o=[];function c(e,n){var t="on"+e.type.charAt(0).toUpperCase()+e.type.substr(1),o=l();r[t]&&r[t]({model:n||o[e.newIndex],models:o,oldIndex:e.oldIndex,newIndex:e.newIndex,originalEvent:e})}function u(e){var n=l();if(n){var t=e.oldIndex,o=e.newIndex;if(s!==e.from){var r=e.from[y]();g=r[t],e.clone?(g=S.copy(g),r.splice(m.utils.index(e.clone,a.options.draggable),0,r.splice(t,1)[0]),e.from.removeChild(e.clone)):r.splice(t,1),n.splice(o,0,g),e.from.insertBefore(e.item,b)}else n.splice(o,0,n.splice(t,1)[0]),b.nodeType===Node.COMMENT_NODE&&e.from.insertBefore(b,e.item.nextSibling);i.$apply()}}s[y]=l,a=m.create(s,Object.keys(r).reduce(function(e,n){return e[n]=e[n]||r[n],e},{onStart:function(e){b=e.from===e.item.parentNode?e.item.nextSibling:e.clone.nextSibling,c(e),i.$apply()},onEnd:function(e){c(e,g),i.$apply()},onAdd:function(e){u(e),c(e,g),i.$apply()},onUpdate:function(e){u(e),c(e)},onRemove:function(e){c(e,g)},onSort:function(e){c(e)}})),S.forEach(["sort","disabled","draggable","handle","animation","group","ghostClass","filter","onStart","onEnd","onAdd","onUpdate","onRemove","onSort","onMove","onClone","setData"],function(n){o.push(i.$watch("ngSortable."+n,function(e){void 0!==e&&(r[n]=e,/^on[A-Z]/.test(n)||a.option(n,e))}))}),n=i.$on("$destroy",function(){n(),S.forEach(o,function(e){e()}),a.destroy(),s[y]=null,b=a=o=s=null})}}}}}}])});